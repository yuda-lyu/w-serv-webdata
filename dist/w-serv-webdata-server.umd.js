/*!
 * w-serv-webdata-server v1.0.55
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("fs")):"function"==typeof define&&define.amd?define(["fs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-serv-webdata-server"]=e(t.fs)}(this,(function(t){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,r||"default");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===e(r)?r:String(r)}function n(t,e,n){return(e=r(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=Array.isArray,i="object"==typeof global&&global&&global.Object===Object&&global,u="object"==typeof self&&self&&self.Object===Object&&self,a=i||u||Function("return this")(),c=a.Symbol,s=Object.prototype,f=s.hasOwnProperty,l=s.toString,v=c?c.toStringTag:void 0;var h=Object.prototype.toString;var p="[object Null]",y="[object Undefined]",d=c?c.toStringTag:void 0;function b(t){return null==t?void 0===t?y:p:d&&d in Object(t)?function(t){var e=f.call(t,v),r=t[v];try{t[v]=void 0;var n=!0}catch(t){}var o=l.call(t);return n&&(e?t[v]=r:delete t[v]),o}(t):function(t){return h.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var j="[object Symbol]";function m(t){return"symbol"==typeof t||g(t)&&b(t)==j}var _=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,w=/^\w*$/;function O(t,e){if(o(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!m(t))||(w.test(t)||!_.test(t)||null!=e&&t in Object(e))}function S(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var $="[object AsyncFunction]",T="[object Function]",x="[object GeneratorFunction]",A="[object Proxy]";function D(t){if(!S(t))return!1;var e=b(t);return e==T||e==x||e==$||e==A}var M,E=a["__core-js_shared__"],k=(M=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+M:"";var P=Function.prototype.toString;function I(t){if(null!=t){try{return P.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var C=/^\[object .+?Constructor\]$/,F=Function.prototype,N=Object.prototype,z=F.toString,W=N.hasOwnProperty,L=RegExp("^"+z.call(W).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function U(t){return!(!S(t)||(e=t,k&&k in e))&&(D(t)?L:C).test(I(t));var e}function B(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return U(r)?r:void 0}var Y=B(Object,"create");var H=Object.prototype.hasOwnProperty;var V=Object.prototype.hasOwnProperty;function R(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function J(t,e){return t===e||t!=t&&e!=e}function Z(t,e){for(var r=t.length;r--;)if(J(t[r][0],e))return r;return-1}R.prototype.clear=function(){this.__data__=Y?Y(null):{},this.size=0},R.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},R.prototype.get=function(t){var e=this.__data__;if(Y){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return H.call(e,t)?e[t]:void 0},R.prototype.has=function(t){var e=this.__data__;return Y?void 0!==e[t]:V.call(e,t)},R.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Y&&void 0===e?"__lodash_hash_undefined__":e,this};var q=Array.prototype.splice;function G(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}G.prototype.clear=function(){this.__data__=[],this.size=0},G.prototype.delete=function(t){var e=this.__data__,r=Z(e,t);return!(r<0)&&(r==e.length-1?e.pop():q.call(e,r,1),--this.size,!0)},G.prototype.get=function(t){var e=this.__data__,r=Z(e,t);return r<0?void 0:e[r][1]},G.prototype.has=function(t){return Z(this.__data__,t)>-1},G.prototype.set=function(t,e){var r=this.__data__,n=Z(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var K=B(a,"Map");function Q(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function X(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}X.prototype.clear=function(){this.size=0,this.__data__={hash:new R,map:new(K||G),string:new R}},X.prototype.delete=function(t){var e=Q(this,t).delete(t);return this.size-=e?1:0,e},X.prototype.get=function(t){return Q(this,t).get(t)},X.prototype.has=function(t){return Q(this,t).has(t)},X.prototype.set=function(t,e){var r=Q(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var tt="Expected a function";function et(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(tt);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(et.Cache||X),r}et.Cache=X;var rt,nt,ot,it=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ut=/\\(\\)?/g,at=(rt=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(it,(function(t,r,n,o){e.push(n?o.replace(ut,"$1"):r||t)})),e},nt=et(rt,(function(t){return 500===ot.size&&ot.clear(),t})),ot=nt.cache,nt),ct=at;function st(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var ft=1/0,lt=c?c.prototype:void 0,vt=lt?lt.toString:void 0;function ht(t){if("string"==typeof t)return t;if(o(t))return st(t,ht)+"";if(m(t))return vt?vt.call(t):"";var e=t+"";return"0"==e&&1/t==-ft?"-0":e}function pt(t){return null==t?"":ht(t)}function yt(t,e){return o(t)?t:O(t,e)?[t]:ct(pt(t))}var dt=1/0;function bt(t){if("string"==typeof t||m(t))return t;var e=t+"";return"0"==e&&1/t==-dt?"-0":e}function gt(t,e){for(var r=0,n=(e=yt(e,t)).length;null!=t&&r<n;)t=t[bt(e[r++])];return r&&r==n?t:void 0}function jt(t,e,r){var n=null==t?void 0:gt(t,e);return void 0===n?r:n}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var mt={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,u){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||t,u),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,u=new Array(i);o<i;o++)u[o]=n[o].fn;return u},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,o,i,u){var a=r?r+t:t;if(!this._events[a])return!1;var c,s,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,o),!0;case 5:return f.fn.call(f.context,e,n,o,i),!0;case 6:return f.fn.call(f.context,e,n,o,i,u),!0}for(s=1,c=new Array(l-1);s<l;s++)c[s-1]=arguments[s];f.fn.apply(f.context,c)}else{var v,h=f.length;for(s=0;s<h;s++)switch(f[s].once&&this.removeListener(t,f[s].fn,void 0,!0),l){case 1:f[s].fn.call(f[s].context);break;case 2:f[s].fn.call(f[s].context,e);break;case 3:f[s].fn.call(f[s].context,e,n);break;case 4:f[s].fn.call(f[s].context,e,n,o);break;default:if(!c)for(v=1,c=new Array(l-1);v<l;v++)c[v-1]=arguments[v];f[s].fn.apply(f[s].context,c)}}return!0},a.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||n&&a.context!==n||u(this,i);else{for(var c=0,s=[],f=a.length;c<f;c++)(a[c].fn!==e||o&&!a[c].once||n&&a[c].context!==n)&&s.push(a[c]);s.length?this._events[i]=1===s.length?s[0]:s:u(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}({get exports(){return mt},set exports(t){mt=t}});var _t=mt;function wt(){return new _t}function Ot(t){return"[object Object]"===Object.prototype.toString.call(t)}function St(t){return"[object String]"===Object.prototype.toString.call(t)}function $t(t){return!(!St(t)||""===t)}function Tt(t){return t!=t}function xt(t){let e=!1;if($t(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Tt(t))return!1;e=!0}return e}function At(t,e){return!!Ot(t)&&(!(!$t(e)&&!xt(e))&&e in t)}var Dt={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",o="second",i="minute",u="hour",a="day",c="week",s="month",f="quarter",l="year",v="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},b=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:b,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),o=r%60;return(e<=0?"+":"-")+b(n,2,"0")+":"+b(o,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),o=e.clone().add(n,s),i=r-o<0,u=e.clone().add(n+(i?-1:1),s);return+(-(n+(r-o)/(i?o-u:u-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:a,D:v,h:u,m:i,s:o,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},j="en",m={};m[j]=d;var _="$isDayjsObject",w=function(t){return t instanceof T||!(!t||!t[_])},O=function t(e,r,n){var o;if(!e)return j;if("string"==typeof e){var i=e.toLowerCase();m[i]&&(o=i),r&&(m[i]=r,o=i);var u=e.split("-");if(!o&&u.length>1)return t(u[0])}else{var a=e.name;m[a]=e,o=a}return!n&&o&&(j=o),o||!n&&j},S=function(t,e){if(w(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new T(r)},$=g;$.l=O,$.i=w,$.w=function(t,e){return S(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var T=function(){function d(t){this.$L=O(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[_]=!0}var b=d.prototype;return b.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if($.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(p);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(e)}(t),this.init()},b.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},b.$utils=function(){return $},b.isValid=function(){return!(this.$d.toString()===h)},b.isSame=function(t,e){var r=S(t);return this.startOf(e)<=r&&r<=this.endOf(e)},b.isAfter=function(t,e){return S(t)<this.startOf(e)},b.isBefore=function(t,e){return this.endOf(e)<S(t)},b.$g=function(t,e,r){return $.u(t)?this[e]:this.set(r,t)},b.unix=function(){return Math.floor(this.valueOf()/1e3)},b.valueOf=function(){return this.$d.getTime()},b.startOf=function(t,e){var r=this,n=!!$.u(e)||e,f=$.p(t),h=function(t,e){var o=$.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?o:o.endOf(a)},p=function(t,e){return $.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},y=this.$W,d=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?h(1,0):h(31,11);case s:return n?h(1,d):h(0,d+1);case c:var j=this.$locale().weekStart||0,m=(y<j?y+7:y)-j;return h(n?b-m:b+(6-m),d);case a:case v:return p(g+"Hours",0);case u:return p(g+"Minutes",1);case i:return p(g+"Seconds",2);case o:return p(g+"Milliseconds",3);default:return this.clone()}},b.endOf=function(t){return this.startOf(t,!1)},b.$set=function(t,e){var r,c=$.p(t),f="set"+(this.$u?"UTC":""),h=(r={},r[a]=f+"Date",r[v]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[u]=f+"Hours",r[i]=f+"Minutes",r[o]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],p=c===a?this.$D+(e-this.$W):e;if(c===s||c===l){var y=this.clone().set(v,1);y.$d[h](p),y.init(),this.$d=y.set(v,Math.min(this.$D,y.daysInMonth())).$d}else h&&this.$d[h](p);return this.init(),this},b.set=function(t,e){return this.clone().$set(t,e)},b.get=function(t){return this[$.p(t)]()},b.add=function(n,f){var v,h=this;n=Number(n);var p=$.p(f),y=function(t){var e=S(h);return $.w(e.date(e.date()+Math.round(t*n)),h)};if(p===s)return this.set(s,this.$M+n);if(p===l)return this.set(l,this.$y+n);if(p===a)return y(1);if(p===c)return y(7);var d=(v={},v[i]=e,v[u]=r,v[o]=t,v)[p]||1,b=this.$d.getTime()+n*d;return $.w(b,this)},b.subtract=function(t,e){return this.add(-1*t,e)},b.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||h;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=$.z(this),i=this.$H,u=this.$m,a=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,o,i){return t&&(t[r]||t(e,n))||o[r].slice(0,i)},v=function(t){return $.s(i%12||12,t,"0")},p=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(y,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return $.s(e.$y,4,"0");case"M":return a+1;case"MM":return $.s(a+1,2,"0");case"MMM":return l(r.monthsShort,a,s,3);case"MMMM":return l(s,a);case"D":return e.$D;case"DD":return $.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(i);case"HH":return $.s(i,2,"0");case"h":return v(1);case"hh":return v(2);case"a":return p(i,u,!0);case"A":return p(i,u,!1);case"m":return String(u);case"mm":return $.s(u,2,"0");case"s":return String(e.$s);case"ss":return $.s(e.$s,2,"0");case"SSS":return $.s(e.$ms,3,"0");case"Z":return o}return null}(t)||o.replace(":","")}))},b.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},b.diff=function(n,v,h){var p,y=this,d=$.p(v),b=S(n),g=(b.utcOffset()-this.utcOffset())*e,j=this-b,m=function(){return $.m(y,b)};switch(d){case l:p=m()/12;break;case s:p=m();break;case f:p=m()/3;break;case c:p=(j-g)/6048e5;break;case a:p=(j-g)/864e5;break;case u:p=j/r;break;case i:p=j/e;break;case o:p=j/t;break;default:p=j}return h?p:$.a(p)},b.daysInMonth=function(){return this.endOf(s).$D},b.$locale=function(){return m[this.$L]},b.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=O(t,e,!0);return n&&(r.$L=n),r},b.clone=function(){return $.w(this.$d,this)},b.toDate=function(){return new Date(this.valueOf())},b.toJSON=function(){return this.isValid()?this.toISOString():null},b.toISOString=function(){return this.$d.toISOString()},b.toString=function(){return this.$d.toUTCString()},d}(),x=T.prototype;return S.prototype=x,[["$ms",n],["$s",o],["$m",i],["$H",u],["$W",a],["$M",s],["$y",l],["$D",v]].forEach((function(t){x[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),S.extend=function(t,e){return t.$i||(t(e,T,S),t.$i=!0),S},S.locale=O,S.isDayjs=w,S.unix=function(t){return S(1e3*t)},S.en=m[j],S.Ls=m,S.p={},S}()}({get exports(){return Dt},set exports(t){Dt=t}});var Mt=Dt;function Et(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function kt(){if(!Et(Mt))throw new Error("invalid dayjs");return Mt().format("YYYY-MM-DDTHH:mm:ssZ")}var Pt=/\s/;var It=/^\s+/;function Ct(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Pt.test(t.charAt(e)););return e}(t)+1).replace(It,""):t}var Ft=NaN,Nt=/^[-+]0x[0-9a-f]+$/i,zt=/^0b[01]+$/i,Wt=/^0o[0-7]+$/i,Lt=parseInt;function Ut(t){if("number"==typeof t)return t;if(m(t))return Ft;if(S(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=S(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ct(t);var r=zt.test(t);return r||Wt.test(t)?Lt(t.slice(2),r?2:8):Nt.test(t)?Ft:+t}var Bt=1/0,Yt=17976931348623157e292;function Ht(t){return t?(t=Ut(t))===Bt||t===-Bt?(t<0?-1:1)*Yt:t==t?t:0:0===t?t:0}function Vt(t){var e=Ht(t),r=e%1;return e==e?r?e-r:e:0}function Rt(t){if(!xt(t))return 0;return Ht(t)}function Jt(t){return!!xt(t)&&(t=Rt(t),"number"==typeof(e=t)&&e==Vt(e));var e}var Zt=a.isFinite,qt=Math.min;var Gt=function(t){var e=Math[t];return function(t,r){if(t=Ut(t),(r=null==r?0:qt(Vt(r),292))&&Zt(t)){var n=(pt(t)+"e").split("e");return+((n=(pt(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),Kt=Gt;function Qt(t){if(!xt(t))return 0;t=Rt(t);let e=Kt(t);return"0"===String(e)?0:e}function Xt(t){if(!Jt(t))return!1;return Qt(t)>0}let te="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),ee=te.length;function re(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];t=Xt(t)?Qt(t):32;for(let r=0;r<t;r++)e[r]=te[0|Math.random()*ee];return e.join("")}function ne(t){if(Ot(t)){for(let e in t)return!0;return!1}return!1}var oe="[object Boolean]";function ie(t){return!0===(e=t)||!1===e||g(e)&&b(e)==oe;var e}var ue=function(){return a.Date.now()},ae="Expected a function",ce=Math.max,se=Math.min;function fe(t,e,r){var n,o,i,u,a,c,s=0,f=!1,l=!1,v=!0;if("function"!=typeof t)throw new TypeError(ae);function h(e){var r=n,i=o;return n=o=void 0,s=e,u=t.apply(i,r)}function p(t){var r=t-c;return void 0===c||r>=e||r<0||l&&t-s>=i}function y(){var t=ue();if(p(t))return d(t);a=setTimeout(y,function(t){var r=e-(t-c);return l?se(r,i-(t-s)):r}(t))}function d(t){return a=void 0,v&&n?h(t):(n=o=void 0,u)}function b(){var t=ue(),r=p(t);if(n=arguments,o=this,c=t,r){if(void 0===a)return function(t){return s=t,a=setTimeout(y,e),f?h(t):u}(c);if(l)return clearTimeout(a),a=setTimeout(y,e),h(c)}return void 0===a&&(a=setTimeout(y,e)),u}return e=Ut(e)||0,S(r)&&(f=!!r.leading,i=(l="maxWait"in r)?ce(Ut(r.maxWait)||0,e):i,v="trailing"in r?!!r.trailing:v),b.cancel=function(){void 0!==a&&clearTimeout(a),s=0,n=c=o=a=void 0},b.flush=function(){return void 0===a?u:d(ue())},b}function le(t){var e=this.__data__=new G(t);this.size=e.size}le.prototype.clear=function(){this.__data__=new G,this.size=0},le.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},le.prototype.get=function(t){return this.__data__.get(t)},le.prototype.has=function(t){return this.__data__.has(t)},le.prototype.set=function(t,e){var r=this.__data__;if(r instanceof G){var n=r.__data__;if(!K||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new X(n)}return r.set(t,e),this.size=r.size,this};var ve=function(){try{var t=B(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),he=ve;function pe(t,e,r){"__proto__"==e&&he?he(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function ye(t,e,r){(void 0!==r&&!J(t[e],r)||void 0===r&&!(e in t))&&pe(t,e,r)}var de,be=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var a=i[de?u:++n];if(!1===e(o[a],a,o))break}return t},ge="object"==typeof exports&&exports&&!exports.nodeType&&exports,je=ge&&"object"==typeof module&&module&&!module.nodeType&&module,me=je&&je.exports===ge?a.Buffer:void 0,_e=me?me.allocUnsafe:void 0;function we(t,e){if(e)return t.slice();var r=t.length,n=_e?_e(r):new t.constructor(r);return t.copy(n),n}var Oe=a.Uint8Array;function Se(t){var e=new t.constructor(t.byteLength);return new Oe(e).set(new Oe(t)),e}function $e(t,e){var r=e?Se(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Te(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var xe=Object.create,Ae=function(){function t(){}return function(e){if(!S(e))return{};if(xe)return xe(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),De=Ae;function Me(t,e){return function(r){return t(e(r))}}var Ee=Me(Object.getPrototypeOf,Object),ke=Object.prototype;function Pe(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ke)}function Ie(t){return"function"!=typeof t.constructor||Pe(t)?{}:De(Ee(t))}function Ce(t){return g(t)&&"[object Arguments]"==b(t)}var Fe=Object.prototype,Ne=Fe.hasOwnProperty,ze=Fe.propertyIsEnumerable,We=Ce(function(){return arguments}())?Ce:function(t){return g(t)&&Ne.call(t,"callee")&&!ze.call(t,"callee")},Le=We,Ue=9007199254740991;function Be(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Ue}function Ye(t){return null!=t&&Be(t.length)&&!D(t)}var He="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ve=He&&"object"==typeof module&&module&&!module.nodeType&&module,Re=Ve&&Ve.exports===He?a.Buffer:void 0,Je=(Re?Re.isBuffer:void 0)||function(){return!1},Ze="[object Object]",qe=Function.prototype,Ge=Object.prototype,Ke=qe.toString,Qe=Ge.hasOwnProperty,Xe=Ke.call(Object);var tr={};function er(t){return function(e){return t(e)}}tr["[object Float32Array]"]=tr["[object Float64Array]"]=tr["[object Int8Array]"]=tr["[object Int16Array]"]=tr["[object Int32Array]"]=tr["[object Uint8Array]"]=tr["[object Uint8ClampedArray]"]=tr["[object Uint16Array]"]=tr["[object Uint32Array]"]=!0,tr["[object Arguments]"]=tr["[object Array]"]=tr["[object ArrayBuffer]"]=tr["[object Boolean]"]=tr["[object DataView]"]=tr["[object Date]"]=tr["[object Error]"]=tr["[object Function]"]=tr["[object Map]"]=tr["[object Number]"]=tr["[object Object]"]=tr["[object RegExp]"]=tr["[object Set]"]=tr["[object String]"]=tr["[object WeakMap]"]=!1;var rr="object"==typeof exports&&exports&&!exports.nodeType&&exports,nr=rr&&"object"==typeof module&&module&&!module.nodeType&&module,or=nr&&nr.exports===rr&&i.process,ir=function(){try{var t=nr&&nr.require&&nr.require("util").types;return t||or&&or.binding&&or.binding("util")}catch(t){}}(),ur=ir&&ir.isTypedArray,ar=ur?er(ur):function(t){return g(t)&&Be(t.length)&&!!tr[b(t)]};function cr(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var sr=Object.prototype.hasOwnProperty;function fr(t,e,r){var n=t[e];sr.call(t,e)&&J(n,r)&&(void 0!==r||e in t)||pe(t,e,r)}function lr(t,e,r,n){var o=!r;r||(r={});for(var i=-1,u=e.length;++i<u;){var a=e[i],c=n?n(r[a],t[a],a,r,t):void 0;void 0===c&&(c=t[a]),o?pe(r,a,c):fr(r,a,c)}return r}var vr=9007199254740991,hr=/^(?:0|[1-9]\d*)$/;function pr(t,e){var r=typeof t;return!!(e=null==e?vr:e)&&("number"==r||"symbol"!=r&&hr.test(t))&&t>-1&&t%1==0&&t<e}var yr=Object.prototype.hasOwnProperty;function dr(t,e){var r=o(t),n=!r&&Le(t),i=!r&&!n&&Je(t),u=!r&&!n&&!i&&ar(t),a=r||n||i||u,c=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],s=c.length;for(var f in t)!e&&!yr.call(t,f)||a&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||pr(f,s))||c.push(f);return c}var br=Object.prototype.hasOwnProperty;function gr(t){if(!S(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Pe(t),r=[];for(var n in t)("constructor"!=n||!e&&br.call(t,n))&&r.push(n);return r}function jr(t){return Ye(t)?dr(t,!0):gr(t)}function mr(t,e,r,n,i,u,a){var c=cr(t,r),s=cr(e,r),f=a.get(s);if(f)ye(t,r,f);else{var l,v=u?u(c,s,r+"",t,e,a):void 0,h=void 0===v;if(h){var p=o(s),y=!p&&Je(s),d=!p&&!y&&ar(s);v=s,p||y||d?o(c)?v=c:g(l=c)&&Ye(l)?v=Te(c):y?(h=!1,v=we(s,!0)):d?(h=!1,v=$e(s,!0)):v=[]:function(t){if(!g(t)||b(t)!=Ze)return!1;var e=Ee(t);if(null===e)return!0;var r=Qe.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ke.call(r)==Xe}(s)||Le(s)?(v=c,Le(c)?v=function(t){return lr(t,jr(t))}(c):S(c)&&!D(c)||(v=Ie(s))):h=!1}h&&(a.set(s,v),i(v,s,n,u,a),a.delete(s)),ye(t,r,v)}}function _r(t,e,r,n,o){t!==e&&be(e,(function(i,u){if(o||(o=new le),S(i))mr(t,e,u,r,_r,n,o);else{var a=n?n(cr(t,u),i,u+"",t,e,o):void 0;void 0===a&&(a=i),ye(t,u,a)}}),jr)}function wr(t){return t}var Or=Math.max;var Sr=he?function(t,e){return he(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:wr,$r=Sr,Tr=Date.now;var xr=function(t){var e=0,r=0;return function(){var n=Tr(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}($r),Ar=xr;function Dr(t,e){return Ar(function(t,e,r){return e=Or(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=Or(n.length-e,0),u=Array(i);++o<i;)u[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(u),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(t,e,wr),t+"")}var Mr,Er=(Mr=function(t,e,r){_r(t,e,r)},Dr((function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=Mr.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!S(r))return!1;var n=typeof e;return!!("number"==n?Ye(r)&&pr(e,r.length):"string"==n&&e in r)&&J(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var u=e[r];u&&Mr(t,u,r,o)}return t})));function kr(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function Pr(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};if(ne(e)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),e=wt()),!At(e,"emit"))throw new Error("instWConverServer is not an EventEmitter");let o=jt(r,"fpTableTags","");$t(o)||(o="./tableTags.json");let i=jt(r,"genTag");Et(i)||(i=()=>kt()+"|"+re(6));let u=function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];setTimeout((()=>{e.emit(t,...n)}),1)};function a(){let e={};try{if(t.existsSync(o)){let r=function(t){if(!$t(t))return{};let e={};try{e=JSON.parse(t)}catch(t){e={}}return e}(t.readFileSync(o,"utf8"));ne(r)&&(e=r)}}catch(t){u("error",{msg:"readTableTags catch",err:t})}return e}function c(){try{let e=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(kr(t))return"";let r="";try{r=e?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){r=""}return r}(n);t.writeFileSync(o,e,"utf8")}catch(t){u("error",{msg:"writeTableTags catch",err:t})}}let s=fe((()=>{c(),u("changeTableTags",n)}),200);return e.readTableTags=a,e.writeTableTags=c,e.initTableTags=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"useInputFirst";if("useInputOnly"===e)n=t;else if("useStorageOnly"===e)n=a();else if("useInputFirst"===e)n=Er(a(),t);else{if("useStorageFirst"!==e)throw new Error(`invalid mode[${e}]`);n=Er(t,a())}c()},e.setTableTags=function(){n=Er(n,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),c()},e.getTableTags=function(){return n},e.updateTableTag=function(t){n[t]=i(),s()},e}function Ir(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var Cr=Me(Object.keys,Object),Fr=Object.prototype.hasOwnProperty;function Nr(t){if(!Pe(t))return Cr(t);var e=[];for(var r in Object(t))Fr.call(t,r)&&"constructor"!=r&&e.push(r);return e}function zr(t){return Ye(t)?dr(t):Nr(t)}var Wr=function(t,e){return function(r,n){if(null==r)return r;if(!Ye(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}((function(t,e){return t&&be(t,e,zr)})),Lr=Wr;function Ur(t,e){var r;return(o(t)?Ir:Lr)(t,"function"==typeof(r=e)?r:wr)}function Br(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new X;++e<r;)this.add(t[e])}function Yr(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function Hr(t,e){return t.has(e)}Br.prototype.add=Br.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Br.prototype.has=function(t){return this.__data__.has(t)};var Vr=1,Rr=2;function Jr(t,e,r,n,o,i){var u=r&Vr,a=t.length,c=e.length;if(a!=c&&!(u&&c>a))return!1;var s=i.get(t),f=i.get(e);if(s&&f)return s==e&&f==t;var l=-1,v=!0,h=r&Rr?new Br:void 0;for(i.set(t,e),i.set(e,t);++l<a;){var p=t[l],y=e[l];if(n)var d=u?n(y,p,l,e,t,i):n(p,y,l,t,e,i);if(void 0!==d){if(d)continue;v=!1;break}if(h){if(!Yr(e,(function(t,e){if(!Hr(h,e)&&(p===t||o(p,t,r,n,i)))return h.push(e)}))){v=!1;break}}else if(p!==y&&!o(p,y,r,n,i)){v=!1;break}}return i.delete(t),i.delete(e),v}function Zr(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function qr(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var Gr=1,Kr=2,Qr="[object Boolean]",Xr="[object Date]",tn="[object Error]",en="[object Map]",rn="[object Number]",nn="[object RegExp]",on="[object Set]",un="[object String]",an="[object Symbol]",cn="[object ArrayBuffer]",sn="[object DataView]",fn=c?c.prototype:void 0,ln=fn?fn.valueOf:void 0;function vn(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}function hn(t,e,r){var n=e(t);return o(t)?n:vn(n,r(t))}function pn(){return[]}var yn=Object.prototype.propertyIsEnumerable,dn=Object.getOwnPropertySymbols,bn=dn?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(dn(t),(function(e){return yn.call(t,e)})))}:pn,gn=bn;function jn(t){return hn(t,zr,gn)}var mn=1,_n=Object.prototype.hasOwnProperty;var wn=B(a,"DataView"),On=B(a,"Promise"),Sn=B(a,"Set"),$n=B(a,"WeakMap"),Tn="[object Map]",xn="[object Promise]",An="[object Set]",Dn="[object WeakMap]",Mn="[object DataView]",En=I(wn),kn=I(K),Pn=I(On),In=I(Sn),Cn=I($n),Fn=b;(wn&&Fn(new wn(new ArrayBuffer(1)))!=Mn||K&&Fn(new K)!=Tn||On&&Fn(On.resolve())!=xn||Sn&&Fn(new Sn)!=An||$n&&Fn(new $n)!=Dn)&&(Fn=function(t){var e=b(t),r="[object Object]"==e?t.constructor:void 0,n=r?I(r):"";if(n)switch(n){case En:return Mn;case kn:return Tn;case Pn:return xn;case In:return An;case Cn:return Dn}return e});var Nn=Fn,zn=1,Wn="[object Arguments]",Ln="[object Array]",Un="[object Object]",Bn=Object.prototype.hasOwnProperty;function Yn(t,e,r,n,i,u){var a=o(t),c=o(e),s=a?Ln:Nn(t),f=c?Ln:Nn(e),l=(s=s==Wn?Un:s)==Un,v=(f=f==Wn?Un:f)==Un,h=s==f;if(h&&Je(t)){if(!Je(e))return!1;a=!0,l=!1}if(h&&!l)return u||(u=new le),a||ar(t)?Jr(t,e,r,n,i,u):function(t,e,r,n,o,i,u){switch(r){case sn:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case cn:return!(t.byteLength!=e.byteLength||!i(new Oe(t),new Oe(e)));case Qr:case Xr:case rn:return J(+t,+e);case tn:return t.name==e.name&&t.message==e.message;case nn:case un:return t==e+"";case en:var a=Zr;case on:var c=n&Gr;if(a||(a=qr),t.size!=e.size&&!c)return!1;var s=u.get(t);if(s)return s==e;n|=Kr,u.set(t,e);var f=Jr(a(t),a(e),n,o,i,u);return u.delete(t),f;case an:if(ln)return ln.call(t)==ln.call(e)}return!1}(t,e,s,r,n,i,u);if(!(r&zn)){var p=l&&Bn.call(t,"__wrapped__"),y=v&&Bn.call(e,"__wrapped__");if(p||y){var d=p?t.value():t,b=y?e.value():e;return u||(u=new le),i(d,b,r,n,u)}}return!!h&&(u||(u=new le),function(t,e,r,n,o,i){var u=r&mn,a=jn(t),c=a.length;if(c!=jn(e).length&&!u)return!1;for(var s=c;s--;){var f=a[s];if(!(u?f in e:_n.call(e,f)))return!1}var l=i.get(t),v=i.get(e);if(l&&v)return l==e&&v==t;var h=!0;i.set(t,e),i.set(e,t);for(var p=u;++s<c;){var y=t[f=a[s]],d=e[f];if(n)var b=u?n(d,y,f,e,t,i):n(y,d,f,t,e,i);if(!(void 0===b?y===d||o(y,d,r,n,i):b)){h=!1;break}p||(p="constructor"==f)}if(h&&!p){var g=t.constructor,j=e.constructor;g==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof g&&g instanceof g&&"function"==typeof j&&j instanceof j||(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,i,u))}function Hn(t,e,r,n,o){return t===e||(null==t||null==e||!g(t)&&!g(e)?t!=t&&e!=e:Yn(t,e,r,n,Hn,o))}var Vn=1,Rn=2;function Jn(t){return t==t&&!S(t)}function Zn(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}function qn(t){var e=function(t){for(var e=zr(t),r=e.length;r--;){var n=e[r],o=t[n];e[r]=[n,o,Jn(o)]}return e}(t);return 1==e.length&&e[0][2]?Zn(e[0][0],e[0][1]):function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var a=r[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var c=(a=r[o])[0],s=t[c],f=a[1];if(u&&a[2]){if(void 0===s&&!(c in t))return!1}else{var l=new le;if(n)var v=n(s,f,c,t,e,l);if(!(void 0===v?Hn(f,s,Vn|Rn,n,l):v))return!1}}return!0}(r,t,e)}}function Gn(t,e){return null!=t&&e in Object(t)}function Kn(t,e){return null!=t&&function(t,e,r){for(var n=-1,i=(e=yt(e,t)).length,u=!1;++n<i;){var a=bt(e[n]);if(!(u=null!=t&&r(t,a)))break;t=t[a]}return u||++n!=i?u:!!(i=null==t?0:t.length)&&Be(i)&&pr(a,i)&&(o(t)||Le(t))}(t,e,Gn)}var Qn=1,Xn=2;function to(t){return function(e){return null==e?void 0:e[t]}}function eo(t){return O(t)?to(bt(t)):function(t){return function(e){return gt(e,t)}}(t)}function ro(t){return"function"==typeof t?t:null==t?wr:"object"==typeof t?o(t)?(e=t[0],r=t[1],O(e)&&Jn(r)?Zn(bt(e),r):function(t){var n=jt(t,e);return void 0===n&&n===r?Kn(t,e):Hn(r,n,Qn|Xn)}):qn(t):eo(t);var e,r}function no(t,e){var r=-1,n=Ye(t)?Array(t.length):[];return Lr(t,(function(t,o,i){n[++r]=e(t,o,i)})),n}var oo=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)vn(e,gn(t)),t=Ee(t);return e}:pn,io=oo;function uo(t){return hn(t,jr,io)}var ao=Object.prototype.hasOwnProperty;var co=/\w*$/;var so=c?c.prototype:void 0,fo=so?so.valueOf:void 0;var lo="[object Boolean]",vo="[object Date]",ho="[object Map]",po="[object Number]",yo="[object RegExp]",bo="[object Set]",go="[object String]",jo="[object Symbol]",mo="[object ArrayBuffer]",_o="[object DataView]",wo="[object Float32Array]",Oo="[object Float64Array]",So="[object Int8Array]",$o="[object Int16Array]",To="[object Int32Array]",xo="[object Uint8Array]",Ao="[object Uint8ClampedArray]",Do="[object Uint16Array]",Mo="[object Uint32Array]";function Eo(t,e,r){var n,o=t.constructor;switch(e){case mo:return Se(t);case lo:case vo:return new o(+t);case _o:return function(t,e){var r=e?Se(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case wo:case Oo:case So:case $o:case To:case xo:case Ao:case Do:case Mo:return $e(t,r);case ho:return new o;case po:case go:return new o(t);case yo:return function(t){var e=new t.constructor(t.source,co.exec(t));return e.lastIndex=t.lastIndex,e}(t);case bo:return new o;case jo:return n=t,fo?Object(fo.call(n)):{}}}var ko=ir&&ir.isMap,Po=ko?er(ko):function(t){return g(t)&&"[object Map]"==Nn(t)};var Io=ir&&ir.isSet,Co=Io?er(Io):function(t){return g(t)&&"[object Set]"==Nn(t)},Fo=1,No=2,zo=4,Wo="[object Arguments]",Lo="[object Function]",Uo="[object GeneratorFunction]",Bo="[object Object]",Yo={};function Ho(t,e,r,n,i,u){var a,c=e&Fo,s=e&No,f=e&zo;if(r&&(a=i?r(t,n,i,u):r(t)),void 0!==a)return a;if(!S(t))return t;var l=o(t);if(l){if(a=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&ao.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!c)return Te(t,a)}else{var v=Nn(t),h=v==Lo||v==Uo;if(Je(t))return we(t,c);if(v==Bo||v==Wo||h&&!i){if(a=s||h?{}:Ie(t),!c)return s?function(t,e){return lr(t,io(t),e)}(t,function(t,e){return t&&lr(e,jr(e),t)}(a,t)):function(t,e){return lr(t,gn(t),e)}(t,function(t,e){return t&&lr(e,zr(e),t)}(a,t))}else{if(!Yo[v])return i?t:{};a=Eo(t,v,c)}}u||(u=new le);var p=u.get(t);if(p)return p;u.set(t,a),Co(t)?t.forEach((function(n){a.add(Ho(n,e,r,n,t,u))})):Po(t)&&t.forEach((function(n,o){a.set(o,Ho(n,e,r,o,t,u))}));var y=l?void 0:(f?s?uo:jn:s?jr:zr)(t);return Ir(y||t,(function(n,o){y&&(n=t[o=n]),fr(a,o,Ho(n,e,r,o,t,u))})),a}Yo[Wo]=Yo["[object Array]"]=Yo["[object ArrayBuffer]"]=Yo["[object DataView]"]=Yo["[object Boolean]"]=Yo["[object Date]"]=Yo["[object Float32Array]"]=Yo["[object Float64Array]"]=Yo["[object Int8Array]"]=Yo["[object Int16Array]"]=Yo["[object Int32Array]"]=Yo["[object Map]"]=Yo["[object Number]"]=Yo[Bo]=Yo["[object RegExp]"]=Yo["[object Set]"]=Yo["[object String]"]=Yo["[object Symbol]"]=Yo["[object Uint8Array]"]=Yo["[object Uint8ClampedArray]"]=Yo["[object Uint16Array]"]=Yo["[object Uint32Array]"]=!0,Yo["[object Error]"]=Yo[Lo]=Yo["[object WeakMap]"]=!1;var Vo=1,Ro=4;function Jo(t){return Ho(t,Vo|Ro)}var Zo="[object String]";var qo=to("length"),Go=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ko="\\ud800-\\udfff",Qo="["+Ko+"]",Xo="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ti="\\ud83c[\\udffb-\\udfff]",ei="[^"+Ko+"]",ri="(?:\\ud83c[\\udde6-\\uddff]){2}",ni="[\\ud800-\\udbff][\\udc00-\\udfff]",oi="(?:"+Xo+"|"+ti+")"+"?",ii="[\\ufe0e\\ufe0f]?",ui=ii+oi+("(?:\\u200d(?:"+[ei,ri,ni].join("|")+")"+ii+oi+")*"),ai="(?:"+[ei+Xo+"?",Xo,ri,ni,Qo].join("|")+")",ci=RegExp(ti+"(?="+ti+")|"+ai+ui,"g");function si(t){return function(t){return Go.test(t)}(t)?function(t){for(var e=ci.lastIndex=0;ci.test(t);)++e;return e}(t):qo(t)}var fi="[object Map]",li="[object Set]";function vi(t){if(null==t)return 0;if(Ye(t))return"string"==typeof(e=t)||!o(e)&&g(e)&&b(e)==Zo?si(t):t.length;var e,r=Nn(t);return r==fi||r==li?t.size:Nr(t).length}function hi(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=wt(),r={},n=null,o=jt(t,"timeAlive");Xt(o)||(o=1e4),o=Qt(o);let i=jt(t,"timeDetect");return Xt(i)||(i=50),i=Qt(i),e.trigger=function(t,u){$t(t)?(At(r,t)||setTimeout((()=>{e.emit("message",{eventName:"enter",key:t,data:u,now:vi(r)})}),1),r[t]={data:u,time:Date.now()},null===n&&(n=setInterval((()=>{Ur(r,((t,n)=>{if(Date.now()-t.time>o){let t=Jo(r[n]);delete r[n],e.emit("message",{eventName:"leave",key:n,data:t.data,now:vi(r)})}})),ne(r)||(clearInterval(n),n=null)}),i))):console.log("trigger need key")},e.get=function(){let t=[];return Ur(r,((e,r)=>{t.push({key:r,data:e.data})})),t=Jo(t),t},e}function pi(t){let e={};if(ne(t)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),t=wt()),!At(t,"emit"))throw new Error("instWConverServer is not an EventEmitter");let r=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];setTimeout((()=>{t.emit(e,...n)}),1)},n=hi(),i=setInterval((()=>{let t=n.get(),r=(u="key",(o(i=t)?st:no)(i,ro(u)));var i,u;let a={};Ur(r,(t=>{a[t]=jt(e,t,[])})),e=a}),1e3);n.on("message",(function(t){let{eventName:e,key:n,data:o,now:i}=t;"enter"===e?r("clientEnter",n,o):"leave"===e&&r("clientLeave",n,o),r("clientChange",i)})),t.on("execute",(function(t,o,i){if("[sys:polling]"===t)try{let t=jt(o,"clientId",""),r=jt(e,t,[]);r=Jo(r),e[t]=[],n.trigger(t,o),i.resolve(r)}catch(t){r("error",t),i.reject("[sys:polling] error")}}));return t.getClients=n.get,t.getMessages=()=>Jo(e),t.broadcast=t=>{if(!ne(e))return;let r={};Ur(e,((e,n)=>{e.push({mode:"broadcast",data:t}),r[n]=e})),e=r},t.clearBroadcast=()=>{clearInterval(i)},t}let yi=(t,e)=>{let r={};return Ur(t,(t=>{let n=t,o=jt(e,t,"");$t(o)&&(r[n]=o)})),r};function di(t,e,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!ne(t))throw new Error("invalid instWConverServer");if(0===vi(e))return t;if(!ne(r))return t;let o=jt(n,"genTag");Et(o)||(o=()=>kt()+"|"+re(6));let i={};return Ur(e,(t=>{i[t]=o()})),t.initTableTags(i,"useInputOnly"),Ur(e,(e=>{let n=r[e];if(!n)throw new Error(`invalid kpOrm[${e}]`);try{n.on("change",(()=>{t.updateTableTag(e)}))}catch(t){throw new Error(`kpOrm[${e}] can not listen to change events`)}})),t.on("changeTableTags",(r=>{t.broadcast({mode:"syncKpTable",data:yi(e,r)})})),t}function bi(t){return"[object Array]"===Object.prototype.toString.call(t)}function gi(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}function ji(t){return t!=t}function mi(t,e,r){return e==e?function(t,e,r){for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,r):function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,ji,r)}function _i(t,e,r,n){for(var o=r-1,i=t.length;++o<i;)if(n(t[o],e))return o;return-1}var wi=Array.prototype.splice;function Oi(t,e){return t&&t.length&&e&&e.length?function(t,e,r,n){var o=n?_i:mi,i=-1,u=e.length,a=t;for(t===e&&(e=Te(e)),r&&(a=st(t,er(r)));++i<u;)for(var c=0,s=e[i],f=r?r(s):s;(c=o(a,f,c,n))>-1;)a!==t&&wi.call(a,c,1),wi.call(t,c,1);return t}(t,e):t}function Si(t){return!!kr(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Ot(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!St(t)||""!==t)}(t)||(!!function(t){return!!bi(t)&&0===t.length}(t)||!!Tt(t)))))}function $i(t){return!!bi(t)&&(0!==t.length&&(1!==t.length||!Si(t[0])))}let Ti=function(t){if(!Et(t))throw new Error("fn is not a function");return function(){let e=function(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}(),r=null,n=null;try{r=t.apply(this,arguments)}catch(t){n=t}return null!==n?e.resolve({state:"error",msg:n}):gi(r)?r.then((t=>{e.resolve({state:"success",msg:t})})).catch((t=>{"cancelled"===jt(t,"reason")?e.resolve({state:"cancelled",msg:""}):e.resolve({state:"error",msg:t})})):e.resolve({state:"success",msg:r}),e}};function xi(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!ne(t))throw new Error("invalid instWConverServer");let r=jt(e,"getUserIdByToken",null);Et(r)||(r=async()=>"");let n=jt(e,"useDbOrm",null);ie(n)||(n=!1);let o=null;if(n&&(o=jt(e,"operOrm",null),!Et(o)))throw new Error("invalid opt.operOrm when useDbOrm=true");let i=[];if(n&&(i=jt(e,"tableNames",null),!bi(i)))throw new Error("invalid opt.tableNames when useDbOrm=true");let u=[];n&&(u=jt(e,"methods",null),bi(u)||(u=["select","insert","save","del"]));let a=jt(e,"kpFunExt",null);let c={};async function s(t,e,n){let o="";if(!At(e,"__sysToken__"))return n.resolve({state:"error",msg:"invalid token"}),n;if(o=function(t){if(!$t(t)&&!xt(t)&&!m(t))return"";let e="";try{e=String(t)}catch(t){}try{e=t.toString()}catch(t){}return e}(e.__sysToken__),!At(e,"__sysInputArgs__"))return n.resolve({state:"error",msg:"invalid input"}),n;e=e.__sysInputArgs__;let i="";if(i=r(o),gi(i)&&(i=await i),$t(i)||(i=""),"[sys:getFuncList]"===t){let t=zr(c);t=function(t,e){if(!$i(t))return[];if((Ot(e)||xt(e)||St(e)||ie(e))&&(e=[e]),!$i(e))return t;let r=Jo(t);return Oi(r,e),r}(t,"[sys:getTableTags]");let e={state:"success",msg:t};return n.resolve(e),n}if(!At(c,t))return n.resolve({state:"error",msg:`invalid func[${t}]`}),n;let u=c[t];try{let t=await Ti(u)(i,...e);n.resolve(t)}catch(e){n.resolve({state:"error",msg:`call func[${t}] has an error: ${e.message}`})}return n}return n&&(i=Jo(i),c=function(t,e,r){let n={};return Ur(t,(t=>{Ur(e,(e=>{n[`${t}.${e}`]=async function(n,o){return await r(n,t,e,o)}}))})),n}(i,u,o)),ne(a)&&Ur(a,((t,e)=>{c[e]=t})),t.on("execute",(async function(e,r,n){await s(e,r,n).catch((r=>{t.emit("error",r),n.resolve({state:"error",msg:`execFun func[${e}] has an error: ${r.message}`})}))})),t}function Ai(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Di(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ai(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ai(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(ne(t)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),t=wt()),!At(t,"emit"))throw new Error("instWConverServer is not an EventEmitter");let r=jt(e,"fpTableTags",null);$t(r)||(r="./tableTags.json");let n=jt(e,"genTag");Et(n)||(n=()=>kt()+"|"+re(6)),t=new pi(t=new Pr(t,{fpTableTags:r,genTag:n}));let o=jt(e,"useDbOrm",null);ie(o)||(o=!0);let i=jt(e,"kpOrm",null),u=jt(e,"operOrm",null),a=jt(e,"tableNamesExec",null),c=jt(e,"methodsExec",null),s=jt(e,"tableNamesSync",null),f=jt(e,"getUserIdByToken",null),l=jt(e,"kpFunExt",null);if(ne(l)||(l={}),l=Di(Di({},l),{},{"[sys:getTableTags]":()=>{let e=t.getTableTags();return{mode:"syncKpTable",data:yi(s,e)}}}),t=new xi(t,{getUserIdByToken:f,useDbOrm:o,operOrm:u,tableNames:a,methods:c,kpFunExt:l}),o){if(!Ot(i))return t.emit("error","invalid opt.kpOrm when useDbOrm=true"),t;t=new di(t,s,i,{genTag:n})}return t}}));
//# sourceMappingURL=w-serv-webdata-server.umd.js.map
