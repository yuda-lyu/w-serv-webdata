/*!
 * w-serv-webdata-server v1.0.31
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("path"),require("fs")):"function"==typeof define&&define.amd?define(["path","fs"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-serv-webdata-server"]=e(t.path,t.fs)}(this,(function(t,e){"use strict";var r=Array.isArray,n="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")(),u=i.Symbol,a=Object.prototype,c=a.hasOwnProperty,s=a.toString,f=u?u.toStringTag:void 0;var l=Object.prototype.toString;var v="[object Null]",p="[object Undefined]",h=u?u.toStringTag:void 0;function b(t){return null==t?void 0===t?p:v:h&&h in Object(t)?function(t){var e=c.call(t,f),r=t[f];try{t[f]=void 0;var n=!0}catch(t){}var o=s.call(t);return n&&(e?t[f]=r:delete t[f]),o}(t):function(t){return l.call(t)}(t)}function y(t){return null!=t&&"object"==typeof t}var d="[object Symbol]";function g(t){return"symbol"==typeof t||y(t)&&b(t)==d}var j=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/;function _(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var O="[object AsyncFunction]",w="[object Function]",S="[object GeneratorFunction]",$="[object Proxy]";function T(t){if(!_(t))return!1;var e=b(t);return e==w||e==S||e==O||e==$}var M,x=i["__core-js_shared__"],A=(M=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||""))?"Symbol(src)_1."+M:"";var D=Function.prototype.toString;function k(t){if(null!=t){try{return D.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var P=/^\[object .+?Constructor\]$/,F=Function.prototype,I=Object.prototype,E=F.toString,N=I.hasOwnProperty,C=RegExp("^"+E.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function W(t){return!(!_(t)||(e=t,A&&A in e))&&(T(t)?C:P).test(k(t));var e}function z(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return W(r)?r:void 0}var U=z(Object,"create");var R=Object.prototype.hasOwnProperty;var L=Object.prototype.hasOwnProperty;function Y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function B(t,e){return t===e||t!=t&&e!=e}function H(t,e){for(var r=t.length;r--;)if(B(t[r][0],e))return r;return-1}Y.prototype.clear=function(){this.__data__=U?U(null):{},this.size=0},Y.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Y.prototype.get=function(t){var e=this.__data__;if(U){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return R.call(e,t)?e[t]:void 0},Y.prototype.has=function(t){var e=this.__data__;return U?void 0!==e[t]:L.call(e,t)},Y.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=U&&void 0===e?"__lodash_hash_undefined__":e,this};var V=Array.prototype.splice;function J(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}J.prototype.clear=function(){this.__data__=[],this.size=0},J.prototype.delete=function(t){var e=this.__data__,r=H(e,t);return!(r<0)&&(r==e.length-1?e.pop():V.call(e,r,1),--this.size,!0)},J.prototype.get=function(t){var e=this.__data__,r=H(e,t);return r<0?void 0:e[r][1]},J.prototype.has=function(t){return H(this.__data__,t)>-1},J.prototype.set=function(t,e){var r=this.__data__,n=H(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var q=z(i,"Map");function G(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Z(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Z.prototype.clear=function(){this.size=0,this.__data__={hash:new Y,map:new(q||J),string:new Y}},Z.prototype.delete=function(t){var e=G(this,t).delete(t);return this.size-=e?1:0,e},Z.prototype.get=function(t){return G(this,t).get(t)},Z.prototype.has=function(t){return G(this,t).has(t)},Z.prototype.set=function(t,e){var r=G(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};var Q="Expected a function";function K(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Q);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var u=t.apply(this,n);return r.cache=i.set(o,u)||i,u};return r.cache=new(K.Cache||Z),r}K.Cache=Z;var X,tt,et,rt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nt=/\\(\\)?/g,ot=(X=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(rt,(function(t,r,n,o){e.push(n?o.replace(nt,"$1"):r||t)})),e},tt=K(X,(function(t){return 500===et.size&&et.clear(),t})),et=tt.cache,tt),it=ot;var ut=1/0,at=u?u.prototype:void 0,ct=at?at.toString:void 0;function st(t){if("string"==typeof t)return t;if(r(t))return function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(t,st)+"";if(g(t))return ct?ct.call(t):"";var e=t+"";return"0"==e&&1/t==-ut?"-0":e}function ft(t){return null==t?"":st(t)}function lt(t,e){return r(t)?t:function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!g(t))||m.test(t)||!j.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:it(ft(t))}var vt=1/0;function pt(t){if("string"==typeof t||g(t))return t;var e=t+"";return"0"==e&&1/t==-vt?"-0":e}function ht(t,e,r){var n=null==t?void 0:function(t,e){for(var r=0,n=(e=lt(e,t)).length;null!=t&&r<n;)t=t[pt(e[r++])];return r&&r==n?t:void 0}(t,e);return void 0===n?r:n}function bt(t){return"[object Object]"===Object.prototype.toString.call(t)}var yt="[object Boolean]";function dt(t){return!0===(e=t)||!1===e||y(e)&&b(e)==yt;var e}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var gt={};!function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,u){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new o(n,i||t,u),c=r?r+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,u=new Array(i);o<i;o++)u[o]=n[o].fn;return u},a.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},a.prototype.emit=function(t,e,n,o,i,u){var a=r?r+t:t;if(!this._events[a])return!1;var c,s,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,n),!0;case 4:return f.fn.call(f.context,e,n,o),!0;case 5:return f.fn.call(f.context,e,n,o,i),!0;case 6:return f.fn.call(f.context,e,n,o,i,u),!0}for(s=1,c=new Array(l-1);s<l;s++)c[s-1]=arguments[s];f.fn.apply(f.context,c)}else{var v,p=f.length;for(s=0;s<p;s++)switch(f[s].once&&this.removeListener(t,f[s].fn,void 0,!0),l){case 1:f[s].fn.call(f[s].context);break;case 2:f[s].fn.call(f[s].context,e);break;case 3:f[s].fn.call(f[s].context,e,n);break;case 4:f[s].fn.call(f[s].context,e,n,o);break;default:if(!c)for(v=1,c=new Array(l-1);v<l;v++)c[v-1]=arguments[v];f[s].fn.apply(f[s].context,c)}}return!0},a.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},a.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},a.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||n&&a.context!==n||u(this,i);else{for(var c=0,s=[],f=a.length;c<f;c++)(a[c].fn!==e||o&&!a[c].once||n&&a[c].context!==n)&&s.push(a[c]);s.length?this._events[i]=1===s.length?s[0]:s:u(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&u(this,e)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}({get exports(){return gt},set exports(t){gt=t}});var jt=gt;function mt(){return new jt}function _t(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}var Ot,wt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),u=i.length;u--;){var a=i[Ot?u:++n];if(!1===e(o[a],a,o))break}return t},St=wt;function $t(t){return y(t)&&"[object Arguments]"==b(t)}var Tt=Object.prototype,Mt=Tt.hasOwnProperty,xt=Tt.propertyIsEnumerable,At=$t(function(){return arguments}())?$t:function(t){return y(t)&&Mt.call(t,"callee")&&!xt.call(t,"callee")},Dt=At;var kt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Pt=kt&&"object"==typeof module&&module&&!module.nodeType&&module,Ft=Pt&&Pt.exports===kt?i.Buffer:void 0,It=(Ft?Ft.isBuffer:void 0)||function(){return!1},Et=9007199254740991,Nt=/^(?:0|[1-9]\d*)$/;function Ct(t,e){var r=typeof t;return!!(e=null==e?Et:e)&&("number"==r||"symbol"!=r&&Nt.test(t))&&t>-1&&t%1==0&&t<e}var Wt=9007199254740991;function zt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Wt}var Ut={};function Rt(t){return function(e){return t(e)}}Ut["[object Float32Array]"]=Ut["[object Float64Array]"]=Ut["[object Int8Array]"]=Ut["[object Int16Array]"]=Ut["[object Int32Array]"]=Ut["[object Uint8Array]"]=Ut["[object Uint8ClampedArray]"]=Ut["[object Uint16Array]"]=Ut["[object Uint32Array]"]=!0,Ut["[object Arguments]"]=Ut["[object Array]"]=Ut["[object ArrayBuffer]"]=Ut["[object Boolean]"]=Ut["[object DataView]"]=Ut["[object Date]"]=Ut["[object Error]"]=Ut["[object Function]"]=Ut["[object Map]"]=Ut["[object Number]"]=Ut["[object Object]"]=Ut["[object RegExp]"]=Ut["[object Set]"]=Ut["[object String]"]=Ut["[object WeakMap]"]=!1;var Lt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Yt=Lt&&"object"==typeof module&&module&&!module.nodeType&&module,Bt=Yt&&Yt.exports===Lt&&n.process,Ht=function(){try{var t=Yt&&Yt.require&&Yt.require("util").types;return t||Bt&&Bt.binding&&Bt.binding("util")}catch(t){}}(),Vt=Ht&&Ht.isTypedArray,Jt=Vt?Rt(Vt):function(t){return y(t)&&zt(t.length)&&!!Ut[b(t)]},qt=Object.prototype.hasOwnProperty;function Gt(t,e){var n=r(t),o=!n&&Dt(t),i=!n&&!o&&It(t),u=!n&&!o&&!i&&Jt(t),a=n||o||i||u,c=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],s=c.length;for(var f in t)!e&&!qt.call(t,f)||a&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Ct(f,s))||c.push(f);return c}var Zt=Object.prototype;function Qt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Zt)}function Kt(t,e){return function(r){return t(e(r))}}var Xt=Kt(Object.keys,Object),te=Object.prototype.hasOwnProperty;function ee(t){if(!Qt(t))return Xt(t);var e=[];for(var r in Object(t))te.call(t,r)&&"constructor"!=r&&e.push(r);return e}function re(t){return null!=t&&zt(t.length)&&!T(t)}function ne(t){return re(t)?Gt(t):ee(t)}var oe=function(t,e){return function(r,n){if(null==r)return r;if(!re(r))return t(r,n);for(var o=r.length,i=e?o:-1,u=Object(r);(e?i--:++i<o)&&!1!==n(u[i],i,u););return r}}((function(t,e){return t&&St(t,e,ne)})),ie=oe;function ue(t){return t}function ae(t,e){var n;return(r(t)?_t:ie)(t,"function"==typeof(n=e)?n:ue)}var ce=z(i,"DataView"),se=z(i,"Promise"),fe=z(i,"Set"),le=z(i,"WeakMap"),ve="[object Map]",pe="[object Promise]",he="[object Set]",be="[object WeakMap]",ye="[object DataView]",de=k(ce),ge=k(q),je=k(se),me=k(fe),_e=k(le),Oe=b;(ce&&Oe(new ce(new ArrayBuffer(1)))!=ye||q&&Oe(new q)!=ve||se&&Oe(se.resolve())!=pe||fe&&Oe(new fe)!=he||le&&Oe(new le)!=be)&&(Oe=function(t){var e=b(t),r="[object Object]"==e?t.constructor:void 0,n=r?k(r):"";if(n)switch(n){case de:return ye;case ge:return ve;case je:return pe;case me:return he;case _e:return be}return e});var we=Oe,Se="[object String]";var $e,Te=($e="length",function(t){return null==t?void 0:t[$e]}),Me=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var xe="\\ud800-\\udfff",Ae="["+xe+"]",De="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ke="\\ud83c[\\udffb-\\udfff]",Pe="[^"+xe+"]",Fe="(?:\\ud83c[\\udde6-\\uddff]){2}",Ie="[\\ud800-\\udbff][\\udc00-\\udfff]",Ee="(?:"+De+"|"+ke+")"+"?",Ne="[\\ufe0e\\ufe0f]?",Ce=Ne+Ee+("(?:\\u200d(?:"+[Pe,Fe,Ie].join("|")+")"+Ne+Ee+")*"),We="(?:"+[Pe+De+"?",De,Fe,Ie,Ae].join("|")+")",ze=RegExp(ke+"(?="+ke+")|"+We+Ce,"g");function Ue(t){return function(t){return Me.test(t)}(t)?function(t){for(var e=ze.lastIndex=0;ze.test(t);)++e;return e}(t):Te(t)}var Re="[object Map]",Le="[object Set]";function Ye(t){if(null==t)return 0;if(re(t))return"string"==typeof(e=t)||!r(e)&&y(e)&&b(e)==Se?Ue(t):t.length;var e,n=we(t);return n==Re||n==Le?t.size:ee(t).length}function Be(t){var e=this.__data__=new J(t);this.size=e.size}Be.prototype.clear=function(){this.__data__=new J,this.size=0},Be.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Be.prototype.get=function(t){return this.__data__.get(t)},Be.prototype.has=function(t){return this.__data__.has(t)},Be.prototype.set=function(t,e){var r=this.__data__;if(r instanceof J){var n=r.__data__;if(!q||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Z(n)}return r.set(t,e),this.size=r.size,this};var He=function(){try{var t=z(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Ve=He;function Je(t,e,r){"__proto__"==e&&Ve?Ve(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var qe=Object.prototype.hasOwnProperty;function Ge(t,e,r){var n=t[e];qe.call(t,e)&&B(n,r)&&(void 0!==r||e in t)||Je(t,e,r)}function Ze(t,e,r,n){var o=!r;r||(r={});for(var i=-1,u=e.length;++i<u;){var a=e[i],c=n?n(r[a],t[a],a,r,t):void 0;void 0===c&&(c=t[a]),o?Je(r,a,c):Ge(r,a,c)}return r}var Qe=Object.prototype.hasOwnProperty;function Ke(t){if(!_(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Qt(t),r=[];for(var n in t)("constructor"!=n||!e&&Qe.call(t,n))&&r.push(n);return r}function Xe(t){return re(t)?Gt(t,!0):Ke(t)}var tr="object"==typeof exports&&exports&&!exports.nodeType&&exports,er=tr&&"object"==typeof module&&module&&!module.nodeType&&module,rr=er&&er.exports===tr?i.Buffer:void 0,nr=rr?rr.allocUnsafe:void 0;function or(t,e){if(e)return t.slice();var r=t.length,n=nr?nr(r):new t.constructor(r);return t.copy(n),n}function ir(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}function ur(){return[]}var ar=Object.prototype.propertyIsEnumerable,cr=Object.getOwnPropertySymbols,sr=cr?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var u=t[r];e(u,r,t)&&(i[o++]=u)}return i}(cr(t),(function(e){return ar.call(t,e)})))}:ur,fr=sr;function lr(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var vr=Kt(Object.getPrototypeOf,Object),pr=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)lr(e,fr(t)),t=vr(t);return e}:ur,hr=pr;function br(t,e,n){var o=e(t);return r(t)?o:lr(o,n(t))}function yr(t){return br(t,ne,fr)}function dr(t){return br(t,Xe,hr)}var gr=Object.prototype.hasOwnProperty;var jr=i.Uint8Array;function mr(t){var e=new t.constructor(t.byteLength);return new jr(e).set(new jr(t)),e}var _r=/\w*$/;var Or=u?u.prototype:void 0,wr=Or?Or.valueOf:void 0;function Sr(t,e){var r=e?mr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var $r="[object Boolean]",Tr="[object Date]",Mr="[object Map]",xr="[object Number]",Ar="[object RegExp]",Dr="[object Set]",kr="[object String]",Pr="[object Symbol]",Fr="[object ArrayBuffer]",Ir="[object DataView]",Er="[object Float32Array]",Nr="[object Float64Array]",Cr="[object Int8Array]",Wr="[object Int16Array]",zr="[object Int32Array]",Ur="[object Uint8Array]",Rr="[object Uint8ClampedArray]",Lr="[object Uint16Array]",Yr="[object Uint32Array]";function Br(t,e,r){var n,o=t.constructor;switch(e){case Fr:return mr(t);case $r:case Tr:return new o(+t);case Ir:return function(t,e){var r=e?mr(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case Er:case Nr:case Cr:case Wr:case zr:case Ur:case Rr:case Lr:case Yr:return Sr(t,r);case Mr:return new o;case xr:case kr:return new o(t);case Ar:return function(t){var e=new t.constructor(t.source,_r.exec(t));return e.lastIndex=t.lastIndex,e}(t);case Dr:return new o;case Pr:return n=t,wr?Object(wr.call(n)):{}}}var Hr=Object.create,Vr=function(){function t(){}return function(e){if(!_(e))return{};if(Hr)return Hr(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),Jr=Vr;function qr(t){return"function"!=typeof t.constructor||Qt(t)?{}:Jr(vr(t))}var Gr=Ht&&Ht.isMap,Zr=Gr?Rt(Gr):function(t){return y(t)&&"[object Map]"==we(t)};var Qr=Ht&&Ht.isSet,Kr=Qr?Rt(Qr):function(t){return y(t)&&"[object Set]"==we(t)},Xr=1,tn=2,en=4,rn="[object Arguments]",nn="[object Function]",on="[object GeneratorFunction]",un="[object Object]",an={};function cn(t,e,n,o,i,u){var a,c=e&Xr,s=e&tn,f=e&en;if(n&&(a=i?n(t,o,i,u):n(t)),void 0!==a)return a;if(!_(t))return t;var l=r(t);if(l){if(a=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&gr.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!c)return ir(t,a)}else{var v=we(t),p=v==nn||v==on;if(It(t))return or(t,c);if(v==un||v==rn||p&&!i){if(a=s||p?{}:qr(t),!c)return s?function(t,e){return Ze(t,hr(t),e)}(t,function(t,e){return t&&Ze(e,Xe(e),t)}(a,t)):function(t,e){return Ze(t,fr(t),e)}(t,function(t,e){return t&&Ze(e,ne(e),t)}(a,t))}else{if(!an[v])return i?t:{};a=Br(t,v,c)}}u||(u=new Be);var h=u.get(t);if(h)return h;u.set(t,a),Kr(t)?t.forEach((function(r){a.add(cn(r,e,n,r,t,u))})):Zr(t)&&t.forEach((function(r,o){a.set(o,cn(r,e,n,o,t,u))}));var b=l?void 0:(f?s?dr:yr:s?Xe:ne)(t);return _t(b||t,(function(r,o){b&&(r=t[o=r]),Ge(a,o,cn(r,e,n,o,t,u))})),a}an[rn]=an["[object Array]"]=an["[object ArrayBuffer]"]=an["[object DataView]"]=an["[object Boolean]"]=an["[object Date]"]=an["[object Float32Array]"]=an["[object Float64Array]"]=an["[object Int8Array]"]=an["[object Int16Array]"]=an["[object Int32Array]"]=an["[object Map]"]=an["[object Number]"]=an[un]=an["[object RegExp]"]=an["[object Set]"]=an["[object String]"]=an["[object Symbol]"]=an["[object Uint8Array]"]=an["[object Uint8ClampedArray]"]=an["[object Uint16Array]"]=an["[object Uint32Array]"]=!0,an["[object Error]"]=an[nn]=an["[object WeakMap]"]=!1;var sn=1,fn=4;function ln(t){return cn(t,sn|fn)}function vn(t){return"[object Array]"===Object.prototype.toString.call(t)}function pn(t){return"[object String]"===Object.prototype.toString.call(t)}function hn(t){return!(!pn(t)||""===t)}var bn=/\s/;var yn=/^\s+/;function dn(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&bn.test(t.charAt(e)););return e}(t)+1).replace(yn,""):t}var gn=NaN,jn=/^[-+]0x[0-9a-f]+$/i,mn=/^0b[01]+$/i,_n=/^0o[0-7]+$/i,On=parseInt;function wn(t){if("number"==typeof t)return t;if(g(t))return gn;if(_(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=_(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=dn(t);var r=mn.test(t);return r||_n.test(t)?On(t.slice(2),r?2:8):jn.test(t)?gn:+t}var Sn=1/0,$n=17976931348623157e292;function Tn(t){return t?(t=wn(t))===Sn||t===-Sn?(t<0?-1:1)*$n:t==t?t:0:0===t?t:0}function Mn(t){var e=Tn(t),r=e%1;return e==e?r?e-r:e:0}function xn(t){return t!=t}function An(t){let e=!1;if(hn(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(xn(t))return!1;e=!0}return e}function Dn(t){if(!An(t))return 0;return Tn(t)}function kn(t){return!!An(t)&&(t=Dn(t),"number"==typeof(e=t)&&e==Mn(e));var e}var Pn=i.isFinite,Fn=Math.min;var In=function(t){var e=Math[t];return function(t,r){if(t=wn(t),(r=null==r?0:Fn(Mn(r),292))&&Pn(t)){var n=(ft(t)+"e").split("e");return+((n=(ft(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}("round"),En=In;function Nn(t){if(!An(t))return 0;t=Dn(t);let e=En(t);return"0"===String(e)?0:e}let Cn="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Wn=Cn.length;function zn(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];var r;t=kn(r=t)&&Nn(r)>0?Nn(t):32;for(let r=0;r<t;r++)e[r]=Cn[0|Math.random()*Wn];return e.join("")}var Un=function(){return i.Date.now()},Rn="Expected a function",Ln=Math.max,Yn=Math.min;function Bn(t,e,r){var n,o,i,u,a,c,s=0,f=!1,l=!1,v=!0;if("function"!=typeof t)throw new TypeError(Rn);function p(e){var r=n,i=o;return n=o=void 0,s=e,u=t.apply(i,r)}function h(t){var r=t-c;return void 0===c||r>=e||r<0||l&&t-s>=i}function b(){var t=Un();if(h(t))return y(t);a=setTimeout(b,function(t){var r=e-(t-c);return l?Yn(r,i-(t-s)):r}(t))}function y(t){return a=void 0,v&&n?p(t):(n=o=void 0,u)}function d(){var t=Un(),r=h(t);if(n=arguments,o=this,c=t,r){if(void 0===a)return function(t){return s=t,a=setTimeout(b,e),f?p(t):u}(c);if(l)return clearTimeout(a),a=setTimeout(b,e),p(c)}return void 0===a&&(a=setTimeout(b,e)),u}return e=wn(e)||0,_(r)&&(f=!!r.leading,i=(l="maxWait"in r)?Ln(wn(r.maxWait)||0,e):i,v="trailing"in r?!!r.trailing:v),d.cancel=function(){void 0!==a&&clearTimeout(a),s=0,n=c=o=a=void 0},d.flush=function(){return void 0===a?u:y(Un())},d}function Hn(t,e,r){(void 0!==r&&!B(t[e],r)||void 0===r&&!(e in t))&&Je(t,e,r)}var Vn="[object Object]",Jn=Function.prototype,qn=Object.prototype,Gn=Jn.toString,Zn=qn.hasOwnProperty,Qn=Gn.call(Object);function Kn(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function Xn(t,e,n,o,i,u,a){var c=Kn(t,n),s=Kn(e,n),f=a.get(s);if(f)Hn(t,n,f);else{var l,v=u?u(c,s,n+"",t,e,a):void 0,p=void 0===v;if(p){var h=r(s),d=!h&&It(s),g=!h&&!d&&Jt(s);v=s,h||d||g?r(c)?v=c:y(l=c)&&re(l)?v=ir(c):d?(p=!1,v=or(s,!0)):g?(p=!1,v=Sr(s,!0)):v=[]:function(t){if(!y(t)||b(t)!=Vn)return!1;var e=vr(t);if(null===e)return!0;var r=Zn.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Gn.call(r)==Qn}(s)||Dt(s)?(v=c,Dt(c)?v=function(t){return Ze(t,Xe(t))}(c):_(c)&&!T(c)||(v=qr(s))):p=!1}p&&(a.set(s,v),i(v,s,o,u,a),a.delete(s)),Hn(t,n,v)}}function to(t,e,r,n,o){t!==e&&St(e,(function(i,u){if(o||(o=new Be),_(i))Xn(t,e,u,r,to,n,o);else{var a=n?n(Kn(t,u),i,u+"",t,e,o):void 0;void 0===a&&(a=i),Hn(t,u,a)}}),Xe)}var eo=Math.max;var ro=Ve?function(t,e){return Ve(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:ue,no=ro,oo=Date.now;var io=function(t){var e=0,r=0;return function(){var n=oo(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(no),uo=io;function ao(t,e){return uo(function(t,e,r){return e=eo(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=eo(n.length-e,0),u=Array(i);++o<i;)u[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(u),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(t,e,ue),t+"")}var co,so=(co=function(t,e,r){to(t,e,r)},ao((function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=co.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!_(r))return!1;var n=typeof e;return!!("number"==n?re(r)&&Ct(e,r.length):"string"==n&&e in r)&&B(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var u=e[r];u&&co(t,u,r,o)}return t}))),fo={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,r=36e5,n="millisecond",o="second",i="minute",u="hour",a="day",c="week",s="month",f="quarter",l="year",v="date",p="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],r=t%100;return"["+t+(e[(r-20)%10]||e[r]||e[0])+"]"}},d=function(t,e,r){var n=String(t);return!n||n.length>=e?t:""+Array(e+1-n.length).join(r)+t},g={s:d,z:function(t){var e=-t.utcOffset(),r=Math.abs(e),n=Math.floor(r/60),o=r%60;return(e<=0?"+":"-")+d(n,2,"0")+":"+d(o,2,"0")},m:function t(e,r){if(e.date()<r.date())return-t(r,e);var n=12*(r.year()-e.year())+(r.month()-e.month()),o=e.clone().add(n,s),i=r-o<0,u=e.clone().add(n+(i?-1:1),s);return+(-(n+(r-o)/(i?o-u:u-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:s,y:l,w:c,d:a,D:v,h:u,m:i,s:o,ms:n,Q:f}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},j="en",m={};m[j]=y;var _="$isDayjsObject",O=function(t){return t instanceof T||!(!t||!t[_])},w=function t(e,r,n){var o;if(!e)return j;if("string"==typeof e){var i=e.toLowerCase();m[i]&&(o=i),r&&(m[i]=r,o=i);var u=e.split("-");if(!o&&u.length>1)return t(u[0])}else{var a=e.name;m[a]=e,o=a}return!n&&o&&(j=o),o||!n&&j},S=function(t,e){if(O(t))return t.clone();var r="object"==typeof e?e:{};return r.date=t,r.args=arguments,new T(r)},$=g;$.l=w,$.i=O,$.w=function(t,e){return S(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var T=function(){function y(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[_]=!0}var d=y.prototype;return d.parse=function(t){this.$d=function(t){var e=t.date,r=t.utc;if(null===e)return new Date(NaN);if($.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var n=e.match(h);if(n){var o=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],o,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(e)}(t),this.init()},d.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},d.$utils=function(){return $},d.isValid=function(){return!(this.$d.toString()===p)},d.isSame=function(t,e){var r=S(t);return this.startOf(e)<=r&&r<=this.endOf(e)},d.isAfter=function(t,e){return S(t)<this.startOf(e)},d.isBefore=function(t,e){return this.endOf(e)<S(t)},d.$g=function(t,e,r){return $.u(t)?this[e]:this.set(r,t)},d.unix=function(){return Math.floor(this.valueOf()/1e3)},d.valueOf=function(){return this.$d.getTime()},d.startOf=function(t,e){var r=this,n=!!$.u(e)||e,f=$.p(t),p=function(t,e){var o=$.w(r.$u?Date.UTC(r.$y,e,t):new Date(r.$y,e,t),r);return n?o:o.endOf(a)},h=function(t,e){return $.w(r.toDate()[t].apply(r.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(e)),r)},b=this.$W,y=this.$M,d=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return n?p(1,0):p(31,11);case s:return n?p(1,y):p(0,y+1);case c:var j=this.$locale().weekStart||0,m=(b<j?b+7:b)-j;return p(n?d-m:d+(6-m),y);case a:case v:return h(g+"Hours",0);case u:return h(g+"Minutes",1);case i:return h(g+"Seconds",2);case o:return h(g+"Milliseconds",3);default:return this.clone()}},d.endOf=function(t){return this.startOf(t,!1)},d.$set=function(t,e){var r,c=$.p(t),f="set"+(this.$u?"UTC":""),p=(r={},r[a]=f+"Date",r[v]=f+"Date",r[s]=f+"Month",r[l]=f+"FullYear",r[u]=f+"Hours",r[i]=f+"Minutes",r[o]=f+"Seconds",r[n]=f+"Milliseconds",r)[c],h=c===a?this.$D+(e-this.$W):e;if(c===s||c===l){var b=this.clone().set(v,1);b.$d[p](h),b.init(),this.$d=b.set(v,Math.min(this.$D,b.daysInMonth())).$d}else p&&this.$d[p](h);return this.init(),this},d.set=function(t,e){return this.clone().$set(t,e)},d.get=function(t){return this[$.p(t)]()},d.add=function(n,f){var v,p=this;n=Number(n);var h=$.p(f),b=function(t){var e=S(p);return $.w(e.date(e.date()+Math.round(t*n)),p)};if(h===s)return this.set(s,this.$M+n);if(h===l)return this.set(l,this.$y+n);if(h===a)return b(1);if(h===c)return b(7);var y=(v={},v[i]=e,v[u]=r,v[o]=t,v)[h]||1,d=this.$d.getTime()+n*y;return $.w(d,this)},d.subtract=function(t,e){return this.add(-1*t,e)},d.format=function(t){var e=this,r=this.$locale();if(!this.isValid())return r.invalidDate||p;var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=$.z(this),i=this.$H,u=this.$m,a=this.$M,c=r.weekdays,s=r.months,f=r.meridiem,l=function(t,r,o,i){return t&&(t[r]||t(e,n))||o[r].slice(0,i)},v=function(t){return $.s(i%12||12,t,"0")},h=f||function(t,e,r){var n=t<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(b,(function(t,n){return n||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return $.s(e.$y,4,"0");case"M":return a+1;case"MM":return $.s(a+1,2,"0");case"MMM":return l(r.monthsShort,a,s,3);case"MMMM":return l(s,a);case"D":return e.$D;case"DD":return $.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return l(r.weekdaysMin,e.$W,c,2);case"ddd":return l(r.weekdaysShort,e.$W,c,3);case"dddd":return c[e.$W];case"H":return String(i);case"HH":return $.s(i,2,"0");case"h":return v(1);case"hh":return v(2);case"a":return h(i,u,!0);case"A":return h(i,u,!1);case"m":return String(u);case"mm":return $.s(u,2,"0");case"s":return String(e.$s);case"ss":return $.s(e.$s,2,"0");case"SSS":return $.s(e.$ms,3,"0");case"Z":return o}return null}(t)||o.replace(":","")}))},d.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},d.diff=function(n,v,p){var h,b=this,y=$.p(v),d=S(n),g=(d.utcOffset()-this.utcOffset())*e,j=this-d,m=function(){return $.m(b,d)};switch(y){case l:h=m()/12;break;case s:h=m();break;case f:h=m()/3;break;case c:h=(j-g)/6048e5;break;case a:h=(j-g)/864e5;break;case u:h=j/r;break;case i:h=j/e;break;case o:h=j/t;break;default:h=j}return p?h:$.a(h)},d.daysInMonth=function(){return this.endOf(s).$D},d.$locale=function(){return m[this.$L]},d.locale=function(t,e){if(!t)return this.$L;var r=this.clone(),n=w(t,e,!0);return n&&(r.$L=n),r},d.clone=function(){return $.w(this.$d,this)},d.toDate=function(){return new Date(this.valueOf())},d.toJSON=function(){return this.isValid()?this.toISOString():null},d.toISOString=function(){return this.$d.toISOString()},d.toString=function(){return this.$d.toUTCString()},y}(),M=T.prototype;return S.prototype=M,[["$ms",n],["$s",o],["$m",i],["$H",u],["$W",a],["$M",s],["$y",l],["$D",v]].forEach((function(t){M[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),S.extend=function(t,e){return t.$i||(t(e,T,S),t.$i=!0),S},S.locale=w,S.isDayjs=O,S.unix=function(t){return S(1e3*t)},S.en=m[j],S.Ls=m,S.p={},S}()}({get exports(){return fo},set exports(t){fo=t}});var lo=fo;function vo(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function po(t){return"[object Undefined]"===Object.prototype.toString.call(t)}let ho=t.resolve();function bo(){let t={},r=ht(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},"fnTableTags");hn(r)||(r="tableTags.json"),r=`${ho}/${r}`;let n=mt();function o(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),o=1;o<e;o++)r[o-1]=arguments[o];setTimeout((()=>{n.emit(t,...r)}),1)}function i(){let t={};try{if(e.existsSync(r)){let n=function(t){if(!hn(t))return{};let e={};try{e=JSON.parse(t)}catch(t){e={}}return e}(e.readFileSync(r,"utf8"));(function(t){if(bt(t)){for(let e in t)return!0;return!1}return!1})(n)&&(t=n)}}catch(t){o("error",{msg:"readTableTags catch",err:t})}return t}function u(){try{let n=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(po(t))return"";let r="";try{r=e?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){r=""}return r}(t);e.writeFileSync(r,n,"utf8")}catch(t){o("error",{msg:"writeTableTags catch",err:t})}}let a=Bn((()=>{u(),o("changeTableTags",t)}),200);return n.readTableTags=i,n.writeTableTags=u,n.initTableTags=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"useInputFirst";t="useStorageFirst"===r?so(e,i()):"useInputOnly"===r?e:"useStorageOnly"===r?i():so(i(),e),u()},n.setTableTags=function(){t=so(t,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),u()},n.getTableTags=function(){return t},n.updateTableTag=function(e){t[e]=function(){if(!vo(lo))throw new Error("invalid dayjs");return lo().format("YYYY-MM-DDTHH:mm:ssZ")}()+"|"+zn(6),a()},n}function yo(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=mt(),r=ht(t,"instWConverServer",null);if(null===r)return e.emit("error","invalid opt.instWConverServer"),e;let n=ht(t,"dbORMs",null);if(!bt(n))return e.emit("error","invalid opt.dbORMs"),e;let o=ht(t,"tableNames",null);if(!vn(o))return e.emit("error","invalid opt.tableNames"),e;0===Ye(o)&&console.log("opt.tableNames.lenght = 0");let i=ht(t,"fnTableTags",null);hn(i)||(i="tableTags.json");let u=new bo({fnTableTags:i});o=ln(o);let a={};function c(t){let e={};return ae(o,(r=>{let n=r,o=t[r];e[n]=o})),e}return ae(o,(t=>{a[t]=zn(6)})),u.initTableTags(a,"useInputOnly"),ae(o,(t=>{let e=n[t];if(!e)throw new Error(`invalid dbORMs.${t}`);e.on("change",(()=>{u.updateTableTag(t)}))})),r.on("clientEnter",(function(t,e){r.deliver(t,{mode:"syncTable",data:u.readTableTags()})})),u.on("changeTableTags",(t=>{r.broadcast({mode:"syncTable",data:c(t)})})),u}function go(t){return go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},go(t)}function jo(t){var e=function(t,e){if("object"!==go(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==go(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===go(e)?e:String(e)}function mo(t,e,r){return(e=jo(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _o(t){return!!po(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(bt(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!pn(t)||""!==t)}(t)||(!!function(t){return!!vn(t)&&0===t.length}(t)||!!xn(t)))))}function Oo(t){return!!vn(t)&&(0!==t.length&&(1!==t.length||!_o(t[0])))}function wo(t){let e,r=Object.prototype.toString.call(t);if(e="[object Promise]"===r,e)return!0;if("[object Function]"!==r)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}function So(t,e){return!!bt(t)&&(!(!hn(e)&&!An(e))&&e in t)}let $o=function(t){if(!vo(t))throw new Error("fn is not a function");return function(){let e=function(){let t,e,r=new Promise((function(){t=arguments[0],e=arguments[1]}));return r.resolve=t,r.reject=e,r}(),r=null,n=null;try{r=t.apply(this,arguments)}catch(t){n=t}return null!==n?e.resolve({state:"error",msg:n}):wo(r)?r.then((t=>{e.resolve({state:"success",msg:t})})).catch((t=>{"cancelled"===ht(t,"reason")?e.resolve({state:"cancelled",msg:""}):e.resolve({state:"error",msg:t})})):e.resolve({state:"success",msg:r}),e}};function To(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Mo(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?To(Object(r),!0).forEach((function(e){mo(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):To(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}let xo={},Ao=null;async function Do(t){let{func:e,input:r,pm:n}=t,o="";if(!So(r,"__sysToken__"))return n.resolve({state:"error",msg:"invalid token"}),n;if(o=function(t){if(!hn(t)&&!An(t)&&!g(t))return"";let e="";try{e=String(t)}catch(t){}try{e=t.toString()}catch(t){}return e}(r.__sysToken__),!So(r,"__sysInputArgs__"))return n.resolve({state:"error",msg:"invalid input"}),n;r=r.__sysInputArgs__;let i="",u=Ao(o);if(i=wo(u)?await u:u,hn(i)||(i=""),"getFuncList"===e){let t={state:"success",msg:ne(xo)};return n.resolve(t),n}if(!So(xo,e))return n.resolve({state:"error",msg:`invalid func[${e}]`}),n;let a=xo[e];try{let t=await $o(a)(i,...r);n.resolve(t)}catch(t){n.resolve({state:"error",msg:`無法識別func: ${e}`})}return n}function ko(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=mt(),r=ht(t,"instWConverServer",null);if(null===r)return e.emit("error","invalid opt.instWConverServer"),e;Ao=ht(t,"cbGetUserIDFromToken",null),vo(Ao)||(Ao=async()=>"");let n=ht(t,"useDbORM",null);dt(n)||(n=!0);let o=null;if(n&&(o=ht(t,"operORM",null),!vo(o)))return e.emit("error","invalid opt.operORM when useDbORM=true"),e;let i=[];if(n&&(i=ht(t,"tableNames",null),!vn(i)))return e.emit("error","invalid opt.tableNames when useDbORM=true"),e;let u=[];n&&(u=ht(t,"methods",null),vn(u)||(u=["select","insert","save","del"]));let a=ht(t,"extFuncs",null),c=ht(t,"hookBefores",null),s=ht(t,"hookAfters",null),f={};return n&&(i=ln(i),f=function(t,e,r){let n={};return ae(t,(t=>{ae(e,(e=>{n[`${t}.${e}`]=async function(n,o){return await r(n,t,e,o)}}))})),n}(i,u,o)),bt(a)&&ae(a,((t,e)=>{f[e]=t})),xo=f,r.on("execute",(async function(t,r,n){let o={func:t,input:r,pm:n};if(vo(c))try{c(o)}catch(t){e.emit("error",t)}else Oo(c)&&ae(c,(t=>{if(vo(t))try{t(o)}catch(t){e.emit("error",t)}}));let i=await Do(o).catch((t=>{e.emit("error",t)})),u=Mo(Mo({},o),{},{output:i});if(vo(s))try{s(u)}catch(t){e.emit("error",t)}else Oo(s)&&ae(s,(t=>{if(vo(t))try{t(u)}catch(t){e.emit("error",t)}}))})),e}return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=null,r=null,n=mt(),o=ht(t,"instWConverServer",null);if(null===o)return n.emit("error","invalid opt.instWConverServer"),n;let i=ht(t,"useDbORM",null);dt(i)||(i=!0);let u=ht(t,"dbORMs",null),a=ht(t,"operORM",null),c=ht(t,"tableNamesExec",null),s=ht(t,"methodsExec",null),f=ht(t,"tableNamesSync",null),l=ht(t,"cbGetUserIDFromToken",null),v=ht(t,"extFuncs",null),p=ht(t,"hookBefores",null),h=ht(t,"hookAfters",null),b=ht(t,"fnTableTags",null);if(e=new ko({instWConverServer:o,cbGetUserIDFromToken:l,useDbORM:i,operORM:a,tableNames:c,methods:s,extFuncs:v,hookBefores:p,hookAfters:h}),e.on("error",(t=>{n.emit("error",t)})),i){if(!bt(u))return n.emit("error","invalid opt.dbORMs when useDbORM=true"),n;r=new yo({instWConverServer:o,dbORMs:u,tableNames:f,fnTableTags:b}),r.on("error",(t=>{n.emit("error",t)}))}return n.getInstWServWebdataServerExec=()=>e,n.getInstWServWebdataServerSync=()=>r,n}}));
//# sourceMappingURL=w-serv-webdata-server.umd.js.map
